import{u as z}from"./list-67d15fde.js";import{g as L,o as j,a as x,b as V,n as H,u as D,r as k,w as K,c as d,s as T,d as Q,e as J,f as v,h as B,V as X,i as q,j as $,k as N,t as M,l as E,m as G,p as Z}from"./index-a6fc1b5b.js";import{u as ee,V as te,a as R}from"./settings-ed9ef403.js";const ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADICAYAAABS39xVAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADcklEQVR4nO3dMW4TQRhA4YmUK6SghTJFuINrUtBTcQ4UIc5BRU9B7zMQF7S0KXIIkAsiFHmzim3IPuX7Ckue8Uqunv4dr+TTN6++/xoAy3Kya/F0AETcBWu1ORsAT2l9cfvgvgkLyBAsYImu7r3/uH0RLCBjMlhz95IAh3rs2bkJC8iYDdaXry8HwDG9e/tzr+tMWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWEDGbLD2/YdWgGMzYQEZk8Fabc4GwJKYsIAMwQIyBAvImAzW+uJ2APxLjz0rN2EBGbPB+vbj9QA4psvz672uM2EBGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkCFYQIZgARmCBWQIFpAhWECGYAEZggVkCBaQIVhAhmABGYIFZAgWkDEbrMvz6wGwBCYsIGMyWKvN2QBYEhMWkCFYQIZgARmCBWRMBmt9cTuW5M+PAA99r+1nDt0HlsuEBWTMBuvzhxfjKb3/dLNz/e9paNfUdOg+sDwmLCBDsICMbLDmbuMO3QeWJxss4PnJBWvu0YND94HlygULeL7ugjV1pjP1WMH/5swJMGEBGdtgndxbuxoAC2TCAjIEC8gQLCDjN4IZQYNCW7zaAAAAAElFTkSuQmCC";function y(e){return L()?(j(e),!0):!1}function Y(){const e=new Set,n=a=>{e.delete(a)};return{on:a=>{e.add(a);const s=()=>n(a);return y(s),{off:s}},off:n,trigger:a=>Promise.all(Array.from(e).map(s=>s(a)))}}function O(e){return typeof e=="function"?e():D(e)}const oe=typeof window<"u",ae=()=>{};function se(e,n=!0){x()?V(e):n?e():H(e)}function ie(e){var n;const o=O(e);return(n=o==null?void 0:o.$el)!=null?n:o}const P=oe?window:void 0;function re(...e){let n,o,t,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,t,a]=e,n=P):[n,o,t,a]=e,!n)return ae;Array.isArray(o)||(o=[o]),Array.isArray(t)||(t=[t]);const s=[],A=()=>{s.forEach(r=>r()),s.length=0},f=(r,l,c,u)=>(r.addEventListener(l,c,u),()=>r.removeEventListener(l,c,u)),g=K(()=>[ie(n),O(a)],([r,l])=>{A(),r&&s.push(...o.flatMap(c=>t.map(u=>f(r,c,u,l))))},{immediate:!0,flush:"post"}),m=()=>{g(),A()};return y(m),m}function ue(){const e=k(!1);return x()&&V(()=>{e.value=!0}),e}function ce(e){const n=ue();return d(()=>(n.value,!!e()))}function le(e={}){const{window:n=P}=e,o=ce(()=>!!n&&"Notification"in n),t=k(null),a=async()=>{o.value&&"permission"in Notification&&Notification.permission!=="denied"&&await Notification.requestPermission()},{on:s,trigger:A}=Y(),{on:f,trigger:g}=Y(),{on:m,trigger:r}=Y(),{on:l,trigger:c}=Y(),u=async I=>{if(!o.value)return;await a();const i=Object.assign({},e,I);return t.value=new Notification(i.title||"",i),t.value.onclick=A,t.value.onshow=g,t.value.onerror=r,t.value.onclose=c,t.value},h=()=>{t.value&&t.value.close(),t.value=null};if(se(async()=>{o.value&&await a()}),y(h),o.value&&n){const I=n.document;re(I,"visibilitychange",i=>{i.preventDefault(),I.visibilityState==="visible"&&h()})}return{isSupported:o,notification:t,show:u,close:h,onClick:s,onShow:f,onError:m,onClose:l}}const Ie={__name:"Home",setup(e){const n=z(),{items:o,currentItem:t,timeleft:a}=T(n),{countdown:s,setCurrentItem:A,setFinishItem:f}=n,g=ee(),{selectedAlarmFile:m,notify:r}=T(g),l=d(()=>g.selectedBGFile),c=["../../public/kangel01.gif","../../public/kangel02.gif","../../public/kangel03.gif","../../public/kangel04.gif","../../public/ame01.gif","../../public/ame02.gif","../../public/ame03.gif","../../public/ame04.gif"],u=k(0),h=k(0),I=()=>{u.value=(u.value+1)%c.length,h.value+=1};V(()=>{setInterval(I,5e3)}),d(()=>c[u.value]);const i={STOP:0,COUNTING:1,PAUSE:2},C=k(i.STOP);let F=0;const w=()=>{C.value===i.STOP&&o.value.length>0&&A(),t.value.length!==0&&(C.value=i.COUNTING,F=setInterval(()=>{s(),a.value===0&&b()},1e3))},U=()=>{C.value=i.PAUSE,clearInterval(F)},b=()=>{clearInterval(F),C.value=i.STOP;const p=new Audio;if(p.src=m.value,p.play(),r.value){const{show:W}=le({title:"事項完成",body:S.value,icon:"https://github.com/wdaweb.png"});W()}f(),o.value.length>0&&w()},S=d(()=>t.value.length>0?t.value:o.value.length>0?"點擊開始":"沒有事項"),_=d(()=>{const p=Math.floor(a.value/60).toString().padStart(2,"0"),W=(a.value%60).toString().padStart(2,"0");return p+":"+W});return(p,W)=>(Q(),J("div",{style:q({backgroundImage:"url("+l.value+")",backgroundSize:"100vw 100vh",backgroundRepeat:"no-repeat",backgroundPosition:"center -68px"})},[v(X,{class:"vHome"},{default:B(()=>[v($,{width:240,height:220,"aspect-ratio":"4/3",contain:"",src:ne},{default:B(()=>[v(te,{class:"text-center py-15"},{default:B(()=>[v(R,{cols:"12",class:"py-0"},{default:B(()=>[N("h1",null,M(S.value),1),N("h1",null,M(_.value),1)]),_:1}),v(R,{cols:"12",class:"py-0"},{default:B(()=>[C.value!==i.COUNTING?(Q(),E(Z,{key:0,variant:"text",icon:"mdi-play",onClick:w})):G("",!0),C.value===i.COUNTING?(Q(),E(Z,{key:1,variant:"text",icon:"mdi-pause",onClick:U})):G("",!0),D(t).length>0?(Q(),E(Z,{key:2,variant:"text",icon:"mdi-skip-next",onClick:b})):G("",!0)]),_:1})]),_:1})]),_:1})]),_:1})],4))}};export{Ie as default};
